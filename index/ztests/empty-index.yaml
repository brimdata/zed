script: |
  # b isn't in the input so this creates a valid Zed index that is empty
  ! zed dev indexfile create -o index.zng -k b in.zson
  zq -Z index.zng
  echo ===
  zed dev indexfile lookup -z -k \"hello\" index.zng
  echo ===

inputs:
  - name: in.zson
    data: |
      {a:"hello"}

outputs:
  - name: stdout
    data: |
      {
          magic: "zed_index",
          version: 3,
          order: "asc",
          child_field: "_child",
          frame_thresh: 32768,
          sections: [
              0
          ],
          keys: [
              [
                  "b"
              ]
          ]
      }
      ===
      ===
  - name: stderr
    data: |
      no index key field "b" present in record: {b:error("missing")}
